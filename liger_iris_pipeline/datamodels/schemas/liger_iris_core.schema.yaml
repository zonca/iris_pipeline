%YAML 1.1
---
$schema: "http://stsci.edu/schemas/fits-schema/fits-schema"
id: "https://oirlab.github.io/schemas/liger_iris_core.schema"
type: object
properties:
  meta:
    type: object
    properties:
      date:
        title: "UTC date file created"
        type: string
        fits_keyword: DATE
        blend_table: True
      origin:
        title: Organization responsible for creating file
        type: string
        fits_keyword: ORIGIN
        blend_table: True
      time_sys:
        title: principal time system for time-related keywords
        type: string
        fits_keyword: TIMESYS
        blend_table: True
      time_unit:
        title: Default unit applicable to all time values
        type: string
        default: 's'
        fits_keyword: TIMEUNIT
      filename:
        title: Name of the file
        type: string
        fits_keyword: FILENAME
        blend_table: True
      filetype:
        title: Type of data in the file
        type: string
        fits_keyword: FILETYPE
        blend_table: True
      model_type:
        title: Type of data model
        type: string
        fits_keyword: DATAMODL
        blend_table: True
      telescope:
        title: Telescope used to acquire the data
        type: string
        fits_keyword: TELESCOP
        blend_table: True
      asn:
        title: Association information
        type: object
        properties:
          pool_name:
            title: Name of the ASN pool
            type: string
            fits_keyword: ASNPOOL
            blend_table: True
          table_name:
            title: Name of the ASN table
            type: string
            fits_keyword: ASNTABLE
            blend_table: True
          exptype:
            title: Exposure type provided for this exposure in the association
            type: string
            default: 'science'
      program:
        title: Program information
        type: object
        properties:
          title:
            title: Proposal title
            type: string
            fits_keyword: TITLE
            blend_table: True
          pi_name:
            title: Principal investigator name
            type: string
            fits_keyword: PI_NAME
            blend_table: True
          category:
            title: Program category
            type: string
            fits_keyword: CATEGORY
            blend_table: True
          sub_category:
            title: Program sub-category
            type: string
            fits_keyword: SUBCAT
            blend_table: True
          science_category:
            title: Science category assigned during TAC process
            type: string
            fits_keyword: SCICAT
            blend_table: True
          continuation_id:
            title: Continuation of previous program
            type: integer
            fits_keyword: CONT_ID
            blend_table: True
      instrument:
        title: Instrument configuration information
        type: object
        properties:
          name:
            title: Instrument used to acquire the data
            type: string
            enum: [IRIS, LIGER, ANY, N/A]
            fits_keyword: INSTRUME
            blend_table: True
          detector:
            title: Name of detector used to acquire the data
            type: string
            enum: [IRIS1, LIGER1, N/A]
            fits_keyword: DETECTOR
            blend_table: True
          filter:
            title: Name of the filter element used
            type: string
            enum: [ANY, N/A, K, KN3, MULTIPLE]
            fits_keyword: FILTER
            blend_table: True
            blend_rule: multi
          pupil:
            title: Name of the pupil element used
            type: string
            enum: [ANY, CLEAR, N/A]
            fits_keyword: PUPIL
            blend_table: True
          pupil_imaging_lens:
            title: Pupil imaging lens in the optical path?
            type: boolean
            fits_keyword: PILIN
            blend_table: True
          grating:
            title: Name of the grating element used
            type: string
            enum: [MIRROR, N/A, ANY, UNKNOWN, MULTIPLE]
            fits_keyword: GRATING
            blend_table: True
            blend_rule: multi
      exposure:
        title: Exposure parameters
        type: object
        properties:
          count:
            title: Running count of exposures in visit
            type: integer
            fits_keyword: EXPCOUNT
            blend_table: True
          prime_parallel:
            title: Prime or parallel exposure
            type: string
            enum: [PRIME, PARALLEL_COORDINATED, PARALLEL_PURE]
            fits_keyword: EXPRIPAR
            blend_table: True
          type:
            title: Type of data in the exposure
            type: string
            enum:
             [
              # IRIS
              IRIS_IMAGE,
              LIGER_IMAGE,
              # Misc
              N/A, ANY]
            fits_keyword: EXP_TYPE
            blend_table: True
          start_time:
            allOf:
              - type: number
              - fits_keyword: EXPSTART
                title: UTC exposure start time
                blend_table: True
                blend_rule: first
          mid_time:
            allOf:
              - type: number
              - fits_keyword: EXPMID
                title: UTC exposure mid time
                blend_table: True
                blend_rule: mean
          end_time:
            allOf:
              - type: number
                title: UTC exposure end time
                fits_keyword: EXPEND
                blend_table: True
                blend_rule: last
          readpatt:
            title: Readout pattern
            type: string
            enum: [ACQ1, ACQ2, BRIGHT1, BRIGHT2,
              DEEP2, DEEP8, FAST, FASTGRPAVG,
              FGS, FGS60, FGS8370, FGS840, FGSRAPID, FINEGUIDE,
              ID, MEDIUM2, MEDIUM8, NIS, NISRAPID,
              NRS, NRSIRS2, NRSN16R4, NRSN32R8, NRSN8R2,
              NRSRAPID, NRSIRS2RAPID, NRSSLOW, RAPID,
              SHALLOW2, SHALLOW4, SLOW, TRACK, ANY, N/A]
            fits_keyword: READPATT
            blend_table: True
          segment_number:
            title: Sequential segment number
            type: integer
            fits_keyword: EXSEGNUM
            blend_table: True
            blend_rule: first
          segment_total:
            title: Total number of segments
            type: integer
            fits_keyword: EXSEGTOT
            blend_table: True
          noutputs:
            title: Number of detector outputs used
            type: integer
            enum: [1, 4]
            fits_keyword: NOUTPUTS
            blend_table: True
          nints:
            title: Number of integrations in exposure
            type: integer
            fits_keyword: NINTS
            blend_table: True
          integration_start:
            title: Starting integration number in this segment
            type: integer
            fits_keyword: INTSTART
            blend_table: True
            blend_rule: min
          integration_end:
            title: Ending integration number in this segment
            type: integer
            fits_keyword: INTEND
            blend_table: True
            blend_rule: max
          ngroups:
            title: Number of groups in integration
            type: integer
            fits_keyword: NGROUPS
            blend_table: True
          nframes:
            title: Number of frames per group
            type: integer
            fits_keyword: NFRAMES
            blend_table: True
          nsamples:
            title: Number of A/D samples per pixel
            type: integer
            fits_keyword: NSAMPLES
            blend_table: True
          sample_time:
            title: "[us] Time between samples"
            type: number
            fits_keyword: TSAMPLE
            blend_table: True
          frame_time:
            title: "[s] Time between frames"
            type: number
            fits_keyword: TFRAME
            blend_table: True
          group_time:
            title: "[s] Time between groups"
            type: number
            fits_keyword: TGROUP
            blend_table: True
          integration_time:
            title: "[s] Effective integration time"
            type: number
            fits_keyword: EFFINTTM
            blend_table: True
          exposure_time:
            title: "[s] Effective exposure time"
            type: number
            fits_keyword: EFFEXPTM
            blend_rule: sum
            blend_table: True
          duration:
            title: "[s] Total duration of exposure"
            type: number
            fits_keyword: DURATION
            blend_rule: sum
            blend_table: True
          nresets_at_start:
            title: Number of resets at start of exposure
            type: integer
            fits_keyword: NRSTSTRT
            blend_table: True
          nresets_between_ints:
            title: Number of resets between integrations
            type: integer
            fits_keyword: NRESETS
            blend_table: True
          zero_frame:
            title: Zero frame was downlinked separately
            type: boolean
            fits_keyword: ZEROFRAM
            blend_table: True
          data_problem:
            title: Science telemetry indicated a problem
            type: boolean
            fits_keyword: DATAPROB
            blend_table: True
          sca_num:
            title: Sensor Chip Assembly number
            type: integer
            fits_keyword: SCA_NUM
            blend_table: True
          datamode:
            title: post-processing method used in FPAP
            type: integer
            fits_keyword: DATAMODE
            blend_table: True
          gain_factor:
            title: Gain scale factor
            type: number
            fits_keyword: GAINFACT
            blend_table: True
      cal_step:
        title: Calibration step information
        type: object
        properties:
          align_psfs:
            title: Coronagraphic PSF Alignment
            type: string
            fits_keyword: S_PSFALI
            blend_table: True
          ami_analyze:
            title: AMI Fringe Analysis
            type: string
            fits_keyword: S_AMIANA
            blend_table: True
          ami_average:
            title: AMI Fringe Averaging
            type: string
            fits_keyword: S_AMIAVG
            blend_table: True
          ami_normalize:
            title: AMI Fringe Normalization
            type: string
            fits_keyword: S_AMINOR
            blend_table: True
          assign_wcs:
            title: Assign World Coordinate System
            type: string
            fits_keyword: S_WCS
            blend_table: True
          assign_mtwcs:
            title: Assign Moving Target World Coordinate System
            type: string
            fits_keyword: S_MTWCS
            blend_table: True
          back_sub:
            title: Background subtraction
            type: string
            fits_keyword: S_BKDSUB
            blend_table: True
          barshadow:
            title: Bar shadow correction
            type: string
            fits_keyword: S_BARSHA
            blend_table: True
          charge_migration:
            title: Charge Migration
            type: string
            fits_keyword: S_CHGMIG
            blend_table: True
          combine_1d:
            title: 1-D Spectral Combination
            type: string
            fits_keyword: S_COMB1D
            blend_table: True
          cube_build:
            title: IFU Cube Creation
            type: string
            fits_keyword: S_IFUCUB
            blend_table: True
          dark_sub:
            title: Dark Subtraction
            type: string
            fits_keyword: S_DARK
            blend_table: True
          dq_init:
            title: Data Quality Initialization
            type: string
            fits_keyword: S_DQINIT
            blend_table: True
          emicorr:
            title: MIRI EMI Correction
            type: string
            fits_keyword: S_MIREMI
            blend_table: True
          emission:
            title: Telescope Emission Correction
            type: string
            fits_keyword: S_TELEMI
            blend_table: True
          err_init:
            title: Error Initialization
            type: string
            fits_keyword: S_ERRINI
            blend_table: True
          extract_1d:
            title: 1-D Spectral Extraction
            type: string
            fits_keyword: S_EXTR1D
            blend_table: True
          extract_2d:
            title: 2-D Spectral Extraction
            type: string
            fits_keyword: S_EXTR2D
            blend_table: True
          firstframe:
            title: First Frame Correction
            type: string
            fits_keyword: S_FRSTFR
            blend_table: True
          flat_field:
            title: Flat Field Correction
            type: string
            fits_keyword: S_FLAT
            blend_table: True
          fringe:
            title: Fringe Correction
            type: string
            fits_keyword: S_FRINGE
            blend_table: True
          gain_scale:
            title: Gain Scale Correction
            type: string
            fits_keyword: S_GANSCL
            blend_table: True
          group_scale:
            title: Group Scale Correction
            type: string
            fits_keyword: S_GRPSCL
            blend_table: True
          guider_cds:
            title: Guide Mode CDS Computation
            type: string
            fits_keyword: S_GUICDS
            blend_table: True
          imprint:
            title: NIRSpec MSA Imprint Subtraction
            type: string
            fits_keyword: S_IMPRNT
            blend_table: True
          ipc:
            title: Interpixel Capacitance Correction
            type: string
            fits_keyword: S_IPC
            blend_table: True
          jump:
            title: Jump Detection
            type: string
            fits_keyword: S_JUMP
            blend_table: True
          klip:
            title: Coronagraphic PSF Subtraction
            type: string
            fits_keyword: S_KLIP
            blend_table: True
          lastframe:
            title: Last Frame Correction
            type: string
            fits_keyword: S_LASTFR
            blend_table: True
          linearity:
            title: Linearity Correction
            type: string
            fits_keyword: S_LINEAR
            blend_table: True
          master_background:
            title: Master Background Subtraction
            type: string
            fits_keyword: S_MSBSUB
            blend_table: True
          mrs_imatch:
            title: MIRI MRS background matching
            type: string
            fits_keyword: S_MRSMAT
            blend_table: True
          msa_flagging:
            title: NIRSpec MSA Stuck Shutter Flagging
            type: string
            fits_keyword: S_MSAFLG
            blend_table: True
          nsclean:
            title: NIRSpec 1/f Noise Correction
            type: string
            fits_keyword: S_NSCLEN
          outlier_detection:
            title: Outlier Detection
            type: string
            fits_keyword: S_OUTLIR
            blend_table: True
          pathloss:
            title: Pathloss Correction
            type: string
            fits_keyword: S_PTHLOS
            blend_table: True
          persistence:
            title: Persistence Correction
            type: string
            fits_keyword: S_PERSIS
            blend_table: True
          photom:
            title: Photometric Calibration
            type: string
            fits_keyword: S_PHOTOM
            blend_table: True
          pixel_replace:
            title: Pixel Replacment
            type: string
            fits_keyword: S_PXREPL
            blend_table: True
          ramp_fit:
            title: Ramp Fitting
            type: string
            fits_keyword: S_RAMP
            blend_table: True
          refpix:
            title: Reference Pixel Correction
            type: string
            fits_keyword: S_REFPIX
            blend_table: True
          resample:
            title: Image resampling
            type: string
            fits_keyword: S_RESAMP
            blend_table: True
          residual_fringe:
            title: Residual fringe Correction
            type: string
            fits_keyword: S_RESFRI
            blend_table: True
          reset:
            title: Reset Anomaly Correction
            type: string
            fits_keyword: S_RESET
            blend_table: True
          rscd:
            title: RSCD Correction
            type: string
            fits_keyword: S_RSCD
            blend_table: True
          saturation:
            title: Saturation Checking
            type: string
            fits_keyword: S_SATURA
            blend_table: True
          skymatch:
            title: Sky Background Equalization or Subtraction
            type: string
            fits_keyword: S_SKYMAT
            blend_table: True
          source_catalog:
            title: Source Photometry and Morphology
            type: string
            fits_keyword: S_SRCCAT
            blend_table: True
          spectral_leak:
            title: MRS spectral leak
            type: string
            fits_keyword: S_SPLEAK
            blend_table: True
          srctype:
            title: Source Type Determination
            type: string
            fits_keyword: S_SRCTYP
            blend_table: True
          stack_psfs:
            title: Coronagraphic PSF Stacking
            type: string
            fits_keyword: S_PSFSTK
            blend_table: True
          straylight:
            title: Straylight Correction
            type: string
            fits_keyword: S_STRAY
            blend_table: True
          superbias:
            title: Superbias Subtraction
            type: string
            fits_keyword: S_SUPERB
            blend_table: True
          tso_photometry:
            title: TSO Imaging Photometry
            type: string
            fits_keyword: S_TSPHOT
            blend_table: True
          tweakreg:
            title: Image Alignment via Astronomical Sources
            type: string
            fits_keyword: S_TWKREG
            blend_table: True
          wavecorr:
            title: NIRSpec wavelength correction
            type: string
            fits_keyword: S_WAVCOR
            blend_table: True
          wfs_combine:
            title: Wavefront Sensing Combination
            type: string
            fits_keyword: S_WFSCOM
            blend_table: True
          white_light:
            title: TSO White-Light Curve
            type: string
            fits_keyword: S_WHTLIT
            blend_table: True  
      subarray:
        title: Subarray parameters
        type: object
        properties:
          name:
            title: Subarray used
            type: string
            # Values grouped by instrument:
            anyOf:
              # All
              - enum:
                  [FULL, CUSTOM, GENERIC, N/A]
            fits_keyword: SUBARRAY
            blend_table: True
          id:
            title: Subarray ID, 0 is full
            type: integer
            fits_keyword: SUBARRID
            blend_table: True
          xstart:
            title: Starting pixel in axis 1 direction
            type: integer
            fits_keyword: SUBSTRT1
            blend_table: True
          ystart:
            title: Starting pixel in axis 2 direction
            type: integer
            fits_keyword: SUBSTRT2
            blend_table: True
          xsize:
            title: Number of pixels in axis 1 direction
            type: integer
            fits_keyword: SUBSIZE1
            blend_table: True
          ysize:
            title: Number of pixels in axis 2 direction
            type: integer
            fits_keyword: SUBSIZE2
            blend_table: True
          fastaxis:
            title: Fast readout axis direction
            type: integer
            fits_keyword: FASTAXIS
            blend_table: True
          slowaxis:
            title: Slow readout axis direction
            type: integer
            fits_keyword: SLOWAXIS
            blend_table: True
          detxcor:
            title: Starting pixel in detector x-axis direction
            type: integer
            fits_keyword: DETXCOR
            blend_table: True
          detycor:
            title: Starting pixel in detector y-axis direction
            type: integer
            fits_keyword: DETYCOR
            blend_table: True
          detxsiz:
            title: Number of pixels in detector x-axis direction
            type: integer
            fits_keyword: DETXSIZ
            blend_table: True
          detysiz:
            title: Number of pixels in detector y-axis direction
            type: integer
            fits_keyword: DETYSIZ
            blend_table: True
      subarray_map:
        title: Subarray map
        type: array
        items:
          type: object
          properties:
            xstart:
              title: Starting pixel in axis 1 direction
              type: integer
            ystart:
              title: Starting pixel in axis 2 direction
              type: integer
            xsize:
              title: Number of pixels in axis 1 direction
              type: integer
            ysize:
              title: Number of pixels in axis 2 direction
              type: integer
